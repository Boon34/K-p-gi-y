<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>H≈© K·∫πo Atomic Habit</title>
    <style>
        :root {
            --jar-color-1: #FF9E9E;
            --jar-color-2: #A0E7E5;
            --candy-color: #FFD700;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            overflow-x: hidden;
        }
        
        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            padding: 30px;
            width: 90%;
            max-width: 600px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        h1 {
            color: #FF6B6B;
            margin-bottom: 10px;
            font-size: 2.2rem;
        }
        
        .subtitle {
            color: #666;
            margin-bottom: 30px;
            font-size: 1rem;
        }
        
        .jars-container {
            display: flex;
            justify-content: space-around;
            margin: 30px 0;
            position: relative;
        }
        
        .jar {
            width: 150px;
            height: 220px;
            border-radius: 10px 10px 60px 60px;
            position: relative;
            cursor: pointer;
            transition: transform 0.3s;
            box-shadow: inset 0 -20px 30px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-top: 20px;
        }
        
        #jar1 {
            background: var(--jar-color-1);
        }
        
        #jar2 {
            background: var(--jar-color-2);
        }
        
        .jar:hover {
            transform: translateY(-5px);
        }
        
        .jar-label {
            font-weight: bold;
            margin-bottom: 15px;
            font-size: 1.2rem;
            color: #333;
        }
        
        .candies {
            width: 90%;
            height: 150px;
            overflow: hidden;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-content: flex-end;
            gap: 5px;
            padding-bottom: 10px;
        }
        
        .candy {
            font-size: 24px;
            transition: all 0.5s;
            user-select: none;
        }
        
        .stats {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
        }
        
        .stat-box {
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #FF6B6B;
        }
        
        .stat-label {
            font-size: 0.8rem;
            color: #666;
        }
        
        .reset-btn {
            background: #FF6B6B;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1rem;
            margin-top: 20px;
            transition: background 0.3s;
        }
        
        .reset-btn:hover {
            background: #FF8E8E;
        }
        
        @keyframes candyFly {
            0% { transform: translate(0, 0) scale(1); opacity: 1; }
            50% { transform: translate(var(--fly-x), var(--fly-y)) scale(1.5); opacity: 0.8; }
            100% { transform: translate(var(--fly-end-x), var(--fly-end-y)) scale(0.5); opacity: 0; }
        }
        
        .flying-candy {
            position: absolute;
            font-size: 24px;
            pointer-events: none;
            z-index: 100;
            animation: candyFly 0.8s forwards;
        }
        
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background: var(--c);
            opacity: 0.8;
            animation: confettiFall 3s linear forwards;
        }
        
        @keyframes confettiFall {
            0% { transform: translateY(-100px) rotate(0deg); opacity: 1; }
            100% { transform: translateY(500px) rotate(360deg); opacity: 0; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>H≈® K·∫∏O ATOMIC HABIT</h1>
        <p class="subtitle">M·ªói ng√†y chuy·ªÉn 1 k·∫πo - X√¢y d·ª±ng th√≥i quen nh·ªè!</p>
        
        <div class="jars-container">
            <div class="jar" id="jar1" onclick="transferCandy(1)">
                <div class="jar-label">H√¥m Nay</div>
                <div class="candies" id="candies1"></div>
            </div>
            
            <div class="jar" id="jar2" onclick="transferCandy(2)">
                <div class="jar-label">Th√†nh T√≠ch</div>
                <div class="candies" id="candies2"></div>
            </div>
        </div>
        
        <div class="stats">
            <div class="stat-box">
                <div class="stat-value" id="streak">0</div>
                <div class="stat-label">Ng√†y li√™n t·ª•c</div>
            </div>
            <div class="stat-box">
                <div class="stat-value" id="completion">0%</div>
                <div class="stat-label">Ho√†n th√†nh</div>
            </div>
        </div>
        
        <button class="reset-btn" onclick="resetJars()">B·∫Øt ƒë·∫ßu l·∫°i</button>
    </div>

    <audio id="candySound" src="https://assets.mixkit.co/sfx/preview/mixkit-arcade-game-jump-coin-216.mp3" preload="auto"></audio>

    <script>
        // Kh·ªüi t·∫°o d·ªØ li·ªáu
        let habitData = {
            candies: [10, 0], // [H≈© 1, H≈© 2]
            streak: 0,
            lastTransferDate: null
        };

        // L·∫•y d·ªØ li·ªáu t·ª´ localStorage (n·∫øu c√≥)
        const savedData = localStorage.getItem('atomicHabitJar');
        if (savedData) {
            habitData = JSON.parse(savedData);
            
            // Ki·ªÉm tra n·∫øu ƒë√£ qua ng√†y m·ªõi
            const today = new Date().toDateString();
            if (habitData.lastTransferDate !== today) {
                // Reset h≈© 1 v·ªÅ 10 k·∫πo n·∫øu l√† ng√†y m·ªõi
                habitData.candies[0] = 10;
            }
        }

        // Hi·ªÉn th·ªã ban ƒë·∫ßu
        updateJars();
        updateStats();

        // H√†m chuy·ªÉn k·∫πo
        function transferCandy(fromJar) {
            const toJar = fromJar === 1 ? 2 : 1;
            
            // Ki·ªÉm tra n·∫øu h≈© ngu·ªìn c√≤n k·∫πo
            if (habitData.candies[fromJar - 1] > 0) {
                // Gi·∫£m k·∫πo ·ªü h≈© ngu·ªìn
                habitData.candies[fromJar - 1]--;
                
                // T·∫°o hi·ªáu ·ª©ng k·∫πo bay
                createFlyingCandy(fromJar, toJar);
                
                // Ph√°t √¢m thanh
                playCandySound();
                
                // C·∫≠p nh·∫≠t streak n·∫øu chuy·ªÉn t·ª´ h≈© 1 sang 2
                if (fromJar === 1) {
                    updateStreak();
                }
                
                // L∆∞u th·ªùi gian chuy·ªÉn cu·ªëi c√πng
                habitData.lastTransferDate = new Date().toDateString();
                
                // L∆∞u v√†o localStorage
                localStorage.setItem('atomicHabitJar', JSON.stringify(habitData));
                
                // C·∫≠p nh·∫≠t giao di·ªán sau khi hi·ªáu ·ª©ng ho√†n th√†nh
                setTimeout(() => {
                    habitData.candies[toJar - 1]++;
                    updateJars();
                    updateStats();
                    
                    // Hi·ªáu ·ª©ng khi ho√†n th√†nh 1 ng√†y (chuy·ªÉn h·∫øt 10 k·∫πo)
                    if (habitData.candies[0] === 0 && habitData.candies[1] === 10) {
                        celebrateCompletion();
                    }
                }, 800);
            }
        }

        // T·∫°o hi·ªáu ·ª©ng k·∫πo bay
        function createFlyingCandy(fromJar, toJar) {
            const fromElement = document.getElementById(`jar${fromJar}`);
            const toElement = document.getElementById(`jar${toJar}`);
            
            const candy = document.createElement('div');
            candy.className = 'flying-candy';
            candy.innerHTML = 'üç¨';
            
            // T√≠nh to√°n v·ªã tr√≠ bay
            const fromRect = fromElement.getBoundingClientRect();
            const toRect = toElement.getBoundingClientRect();
            
            const startX = fromRect.left + fromRect.width / 2;
            const startY = fromRect.top + fromRect.height / 2;
            const endX = toRect.left + toRect.width / 2;
            const endY = toRect.top + toRect.height / 2;
            
            // ƒê·∫∑t bi·∫øn CSS ƒë·ªÉ ƒëi·ªÅu khi·ªÉn animation
            candy.style.setProperty('--fly-x', `${(endX - startX) / 2}px`);
            candy.style.setProperty('--fly-y', `-100px`);
            candy.style.setProperty('--fly-end-x', `${endX - startX}px`);
            candy.style.setProperty('--fly-end-y', `${endY - startY}px`);
            
            candy.style.left = `${startX}px`;
            candy.style.top = `${startY}px`;
            
            document.body.appendChild(candy);
            
            // T·ª± ƒë·ªông x√≥a sau khi animation k·∫øt th√∫c
            setTimeout(() => {
                candy.remove();
            }, 1000);
        }

        // C·∫≠p nh·∫≠t hi·ªÉn th·ªã c√°c h≈© k·∫πo
        function updateJars() {
            const candies1 = document.getElementById('candies1');
            const candies2 = document.getElementById('candies2');
            
            candies1.innerHTML = '';
            candies2.innerHTML = '';
            
            // Th√™m k·∫πo v√†o h≈© 1
            for (let i = 0; i < habitData.candies[0]; i++) {
                const candy = document.createElement('div');
                candy.className = 'candy';
                candy.innerHTML = 'üç¨';
                candies1.appendChild(candy);
            }
            
            // Th√™m k·∫πo v√†o h≈© 2
            for (let i = 0; i < habitData.candies[1]; i++) {
                const candy = document.createElement('div');
                candy.className = 'candy';
                candy.innerHTML = 'üç¨';
                candies2.appendChild(candy);
            }
        }

        // C·∫≠p nh·∫≠t streak
        function updateStreak() {
            const today = new Date();
            const yesterday = new Date(today);
            yesterday.setDate(yesterday.getDate() - 1);
            
            // N·∫øu l·∫ßn chuy·ªÉn cu·ªëi c√πng l√† h√¥m qua => tƒÉng streak
            if (habitData.lastTransferDate === yesterday.toDateString()) {
                habitData.streak++;
            } 
            // N·∫øu kh√¥ng c√≥ d·ªØ li·ªáu ho·∫∑c ƒë√£ qu√° 1 ng√†y => reset streak
            else if (!habitData.lastTransferDate || 
                     new Date(habitData.lastTransferDate).toDateString() !== yesterday.toDateString()) {
                habitData.streak = 1;
            }
            
            updateStats();
        }

        // C·∫≠p nh·∫≠t th·ªëng k√™
        function updateStats() {
            document.getElementById('streak').textContent = habitData.streak;
            
            const completionPercent = Math.round((habitData.candies[1] / 10) * 100);
            document.getElementById('completion').textContent = `${completionPercent}%`;
        }

        // Ph√°t √¢m thanh
        function playCandySound() {
            const sound = document.getElementById('candySound');
            sound.currentTime = 0;
            sound.play();
        }

        // Hi·ªáu ·ª©ng khi ho√†n th√†nh 1 ng√†y
        function celebrateCompletion() {
            // T·∫°o confetti
            const colors = ['#FF6B6B', '#A0E7E5', '#FFD700', '#B5EAEA'];
            
            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.setProperty('--c', colors[Math.floor(Math.random() * colors.length)]);
                confetti.style.left = `${Math.random() * 100}vw`;
                confetti.style.animationDuration = `${Math.random() * 2 + 1}s`;
                document.body.appendChild(confetti);
                
                setTimeout(() => {
                    confetti.remove();
                }, 3000);
            }
            
            // Ph√°t √¢m thanh ƒÉn m·ª´ng
            playCandySound();
        }

        // Reset c√°c h≈©
        function resetJars() {
            habitData.candies = [10, 0];
            updateJars();
            updateStats();
            localStorage.setItem('atomicHabitJar', JSON.stringify(habitData));
        }
    </script>
</body>
</html>
